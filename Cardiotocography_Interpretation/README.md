# A Machine Learning Approach to Cardiotocography Interpretation

#### By Holly Figueroa and KJ MoChroi
#### March 2023


Despite modern advances, childbirth remains a risky medical endeavor both for birthing people and the unborn. There exists no replacement for the expertise and direct involvement of a medical professional to manage care. Analytics, however, can offer significant aid in ways it could not before through advanced modeling. Cardiotocography (CTG) is widely used over the course of pregnancy and during labor (Fetal Heart Monitoring, 2019). CTG allows monitoring of fetal heart rate and uterine contractions to prevent fetal hypoxia, or oxygen loss in body tissues (Boudet et al., 2020). Creating effective modeling for CTG exam data can provide additional support to those dedicated preventing harm and loss of life. The goal of this project will be to build an effective model to classify CTG data using supervised machine learning.  

The dataset chosen for model training contains 2126 instances of heart-health-related features taken from cardiotocogram exams of fetuses. These were then classified by three expert obstetricians into 3 classes: 1 – Normal, 2 – Suspect, or 3- Pathological, making the target a multi-class categorical feature. There are a total of 22 features, both numerical and categorical. We found this dataset on Kaggle, but it was originally published in the Journal of Maternal-Fetal & Neonatal Medicine in the year 2000. We implemented two different models for this project, both of which performed classification on the fetal heart health target feature. The first model is a neural network and the second being a naive Bayes model.

For the Naïve Bayes classifier, we chose to use the Complement Naïve Bayes due to its ability to handle imbalanced classes in the target feature. We used a train-test-split ratio of 80/20 because it yielded the highest accuracy of any ratio we tested, without overfitting the model too much. We then applied a minmax scalar because the model only accepts positive values as input. After that we did a grid search to perform hyperparameter tuning on the only hyperparameter in a complement naïve Bayes model, using accuracy as our scoring metric. This resulted in a model with approximately 84% accuracy.  

For our neural network model, a multilayer perceptive classifier was chosen for our project. Given the strong imbalances between classes, data was train-test-split in a stratified manner. This offered assurance that classes with small counts were not further reduced during the split. A train-test-split ratio of 80/20 was chosen to offer our model a wider range of training cases to learn from. To further accommodate the imbalance between class counts, oversampling was also conducted to increase class counts to match the larger class count, of 1323. This method was chosen instead of under-sampling to better complement this model type which is characterized to benefit from larger training sets. Two scalers were tested, and a standard scaler proved to provide slightly higher accuracy.  

For our MLP classifier, a grid search was conducted to find ideal model hyperparameters. Cross validation however, revealed a lower performance when predicting test data, indicating overfitting. The hyperparameters were tuned manually with cross validation to reach a higher accuracy in predicting outcomes for our test data. The resulting classifier model calculated outcomes with a .91 accuracy score. Outcomes for ‘normal’, ‘suspect’, and ‘pathological’ were returned with True Positive Rates of 95%, 74%, and 80%, respectively. Of particular concern, given the context of this project, were False Negative Rates for non-normal outcomes. Results returned a FNR of 25% for ‘suspect’ and 20% for ‘pathological’ predictions. While this lends confidence for predicting ‘normal’ outcomes, overall, the results show the model is not dependable for predicting riskier outcomes. It is worth noting that both of our models performed much better than the null model with regards to accuracy and in that way, they can be considered successful models.  
